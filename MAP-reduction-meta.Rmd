---
classoptions: 
  - sn-nature      
  # - referee       # Optional: Use double line spacing 
  # - lineno        # Optional: Add line numbers
  # - iicol         # Optional: Double column layour
title: "Durably reducing consumption of meat and animal products is an unsolved problem: results from a meta-analysis"
titlerunning: MAP-reduction-meta
authors: 
  - firstname: Seth Ariel
    lastname: Green
    email: setgree@stanford.edu
    affiliation: 1
    corresponding: TRUE
  - firstname: Maya 
    lastname: Mathur
    affiliation: 1
  - firstname: Benny
    lastname: Smith 
    affiliation: 2
affiliations:
  - number: 1
    info:
      orgdiv: Humane and Sustainable Food Lab
      orgname: Stanford University
  - number: 2
    info:
      orgname: Allied Scholars for Animal Protection 
keywords:
  - key
  - dictionary
  - word
abstract: |
  **Purpose**: 
  **Methods:** 
  **Results:** 
  **Conclusion:**
bibliography: "./manuscript/vegan-refs.bib"
output: 
  rticles::springer_article
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      fig.path='results/figures/',
                      out.extra = "")  # This forces knitr to label all figures.

source('./scripts/libraries.R')
source('./scripts/functions.R')
source('./scripts/load-data.R')
source('./scripts/red-and-processed-meat.R')

# final thing is going to look like
model <-  robumeta::robu(d ~ theory, data = dat, studynum = unique_study_id, var.eff.size = var_d, modelweights = "CORR")

# model <-  robumeta::robu(d ~ theory, data = dat, studynum = unique_study_id, var.eff.size = var_d, modelweights = "HIER")

dat |> 
  ggplot(aes(x = se_d, y = d)) +
  geom_point(size = 3, aes(color = theory)) +
  stat_smooth(method = 'lm', se = FALSE) +
  scale_color_manual(values = c("norms" = "blue",  
                                "norms & persuasion" = "red", 
                                "nudge" = "green", 
                                "persuasion" = "purple" 
                                )) +
  labs(x = "Standard Error") +
  theme_minimal()

```

# Introduction {#sec1}

Consumption of meat and animal products (MAP) is increasingly recognized as a major contributor to premature deaths [@willett2019; @landry2023], public health risks [@slingenbergh2004; @graham2008], ecological harms [@greger2010] and climate change [@scarborough2023; @koneswaran2008] as well as an ethical crisis in its own right [@kuruc2023; @singer2023].

Supply-side interventions, such as banning or taxing certain practices or products, risk political backlash if public opinion is not supportive.
It is of vital importance, therefore, to assess which strategies and theoretical perspectives lead to the largest and most durable reductions in demand for MAP products, under which conditions, and for which populations.

The research on diet and its personal, cultural, and practical antecedents on the one hand and its consequences for health, the environment, and animal welfare on the other is vast.
By our count, there have been over one hundred previous reviews on these questions in the past two decades, with at least thirty-seven focused specifically on MAP reduction.
However, two prior investigations revealed three common gaps in the literature: a dearth of long-term follow-ups, consumption outcomes, and inattention to the gap between intentions and behavior [@mathur2021meta; @mathur2021effectiveness].
Our paper addresses these concerns by meta-analyzing randomized controlled trials (RCTs) that

-   were designed to reduce MAP consumption, rather than (e.g.) encouraging substitution from red to white meat or fish

-   had least 25 subjects each in treatment and control, or, for cluster-randomized trials, at least 10 clusters in total;

-   measured MAP consumption, whether self-reported or observed directly, rather than (or in addition to) attitudes, intentions, beliefs or hypothetical choices;

-   recorded outcomes at least a single day after the start of treatment.

Additionally, studies needed to be publicly circulated by December 2023 and published in English.

```{r useful_constants, include=F, echo=F}
num_papers <- as.numeric(max(dat$unique_paper_id))
num_studies <- as.numeric(max(dat$unique_study_id))
num_interventions <- as.numeric(nrow(dat))
n_total <-  plyr::round_any(x = sum(dat$n_c_total_pop) + sum(dat$n_t_total_pop), 1000, floor)


RPMC_papers <- as.numeric(max(RPMC$unique_paper_id))
RPMC_studies <- as.numeric(max(RPMC$unique_study_id))
RPMC_interventions <- as.numeric(nrow(RPMC))
n_meat_total <-  plyr::round_any(x = sum(RPMC$n_c_total_pop) + sum(RPMC$n_t_total_pop), 1000, floor)

```

In total we, coded `r num_papers` papers [@abrahamse2007; @alblas2023; @aldoh2023; @allen2002; @andersson2021; @acharya2004; @berndsen2005; @bertolaso2015; @bianchi2022; @bochmann2017; @bschaden2020; @carfora2023; @coker2022; @cooney2016; @fehrenbach2015; @feltz2022; @griesoph2021; @haile2021; @hatami2018; @hennessy2016; @jalil2023; @lacroix2020; @mathur2021effectiveness; @mattson2020; @merrill2009; @norris2014; @peacock2017; @piester2020; @polanco2022; @sparkman2017; @sparkman2020; @sparkman2021; @weingarten2022] comprising `r num_studies` separate studies and `r num_interventions` interventions.
We also coded a supplementary dataset of `r RPMC_papers` papers aimed at reducing consumption of red and/or processed meat (RPM) [@carfora2017correlational; @carfora2017randomised; @carfora2019; @carfora2019informational; @delichatsios2001; @dijkstra2022; @emmons2005cancer; @emmons2005project; @jaacks2014; @james2015; @lee2018; @perino2022; @schatzkin2000; @sorensen2005], comprising `r RPMC_studies` studies and `r RPMC_interventions` interventions.
This was to provide a comparison between studies that aimed to reduce overall MAP consumption and those that only measured RPM reductions without reporting on potential substitution to other MAP products [@mathur2022ethical].

Additionally, we compiled a dataset of 779 excluded studies, along with their reason(s) for exclusion.

# Results {#sec2}

## Three theoretical categories: persuasion, choice architecture, and norms{#sec2.1}

```{r table_one, echo=F, message=F}
library(kableExtra)
source('./functions/meta_result_formatter.R')

# Eight categories: overall, nudge, norm, norms + persuasion,
# persuasion (overall), persuasion (health), persuasion (environment), and 
# persuasion (animal welfare). Each gets its own model.

mr <- meta_result_formatter

# Overall
model <- dat |> map_robu()

# Nudge
nudge_model <- dat |> filter(theory == 'nudge') |> map_robu()

# Norms
norms_model <- dat |> filter(theory == 'norms') |> map_robu()

# Norms + Persuasion
norms_persuasion_model <- dat |> filter(theory == 'norms & persuasion') |> map_robu()

# Persuasion Overall
persuasion_model <- dat |> filter(theory == 'persuasion') |> map_robu()

# Table One
table_one <- tibble(
  Approach = c("\\textbf{Overall}", "Nudge", "Norms", "Norms + Persuasion", 
               "Persuasion (Overall)"),
  "N (Studies)" = c(model$N_studies, nudge_model$N_studies, 
                     norms_model$N_studies, norms_persuasion_model$N_studies, 
                     persuasion_model$N_studies),
  "N (Interventions)" = c(model$N_interventions, nudge_model$N_interventions, 
                           norms_model$N_interventions, norms_persuasion_model$N_interventions, 
                           persuasion_model$N_interventions),
  "Glass's $\\Delta$ (SE)" = c(mr(model), mr(nudge_model), mr(norms_model),
                                mr(norms_persuasion_model), mr(persuasion_model))
) |> 
  kable(format = "latex", booktabs = TRUE, escape = FALSE,
        caption = "Nudge, norms, and persuasion approaches to MAP reduction",
        label = "tab:table_one") |>
  kable_styling(latex_options = "hold_position") |>
  footnote(general_title = "",
           general = "* p $<$ 0.05, ** p $<$ 0.01, *** p $<$ 0.001", 
           escape = FALSE)
table_one

# Persuasion (Health)
health_model <- dat |> filter(str_detect(secondary_theory, 'health')) |> map_robu()

# Persuasion (Environment)
environment_model <- dat |> filter(str_detect(secondary_theory, 'environment')) |> map_robu()

# Persuasion (Animal Welfare)
animal_model <- dat |> filter(str_detect(secondary_theory, 'animal')) |> map_robu()

# Table Two
table_two <- tibble(
  "Persuasion Approach" = c("Health", "Environment", "Animal Welfare"),
  "N (Studies)" = c(health_model$N_studies, 
                    environment_model$N_studies,
                    animal_model$N_studies),
  "N (Interventions)" = c(health_model$N_interventions, 
                          environment_model$N_interventions,
                          animal_model$N_interventions),
  "Glass's $\\Delta$ (SE)" = c(mr(health_model), 
                               mr(environment_model), 
                               mr(animal_model))
) |> 
  kable(format = "latex", booktabs = TRUE, escape = FALSE,
        caption = "Three types of persuasion",
        label = "tab:table_two") |>
  kable_styling(latex_options = "hold_position") |>
  footnote(general_title = "", 
           general = "* p $<$ 0.05, ** p $<$ 0.01, *** p $<$ 0.001", 
           escape = FALSE)
table_two
```

## An overall null effect

## Red and Processed Meat is an easier target

```{r RPMC_model, echo=F}
# ok this won't be a table
# rpmc_model <- RPMC |> map_robu()
# 
# table_three <- tibble(
#   "N (Studies)" = rpmc_model$N_studies,
#   "N (Interventions)" = rpmc_model$N_interventions,
#   "Glass's $\\Delta$ (SE)" = mr(rpmc_model)) |> 
#   kable(format = "latex", booktabs = TRUE, escape = FALSE,
#         caption = "Meta-analytic results for red and processed meat",
#         label = "tab:table_three") |>
#   kable_styling(latex_options = "hold_position") |>
#   footnote(general_title = "", 
#            general = "* p $<$ 0.05, ** p $<$ 0.01, *** p $<$ 0.001", 
#            escape = FALSE)
# table_three
```
# Methods {#sec3}

# Discussion {#sec4}

\backmatter

\bmhead{Supplementary information}

\bmhead{Acknowledgments}

# Declarations {.unnumbered}

# Appendix {#secA1}

# Bibliography
